## 요구사항 명세서(SRS) - 싱크홀 안전지도 (SafePath)

### 1. 개요
- 본 문서는 싱크홀 안전지도 시스템의 기능/비기능 요구사항을 명세한다.

### 2. 용어
- 위험도 등급: low/medium/high/critical
- 지하철 영향권: 1차(≤100m), 2차(≤300m), 3차(≤500m)

### 3. 시스템 범위
- 범위: 정적 CSV 입력을 지도/히트맵/시뮬레이션으로 가시화 및 분석
- 제외: 사용자 계정/권한, 서버 DB, 실시간 경로 탐색
 - (복구 후 계획) 공공데이터 API 연계를 통해 정기(또는 준실시간) 동기화로 최신성 확보

### 4. 기능 요구사항
F1. 데이터 로드
- F1.1 시스템은 `public/sago.csv`를 로드/정규화해야 한다.
- F1.2 시스템은 `public/subway.csv`를 로드/정규화해야 한다.
- F1.3 인코딩은 UTF-8 실패 시 EUC-KR로 폴백해야 한다.

F2. 위험도 계산(싱크홀)
- F2.1 클러스터링 반경 기본값 10m로 좌표 근접 점을 묶어야 한다.
- F2.2 크기/피해/시간/반복 가중을 합성해 baseRisk를 산출해야 한다.
- F2.3 baseRisk를 전역 임계값으로 등급화해야 한다.

F3. 지하철 영향도
- F3.1 역/연속 구간 대비 최단거리를 계산해야 한다.
- F3.2 거리권역(100/300/500m)에 따라 선형보간 가중치를 계산해야 한다.
- F3.3 finalRisk = baseRisk × (1 + subwayWeight)를 산출해야 한다.
- F3.4 영향권 레벨(level1/2/3/none)을 표시해야 한다.

F4. 시각화
- F4.1 히트맵은 선택 프리셋의 gradient로 표시해야 한다.
- F4.2 마커는 등급/가중치 기반 색/아이콘/애니메이션을 적용해야 한다.
- F4.3 지하철 영향권 원(100/300/500m) 및 노선을 표시해야 한다.

F5. 시뮬레이션
- F5.1 사용자 파라미터(싱크홀/지하철 가중치 배수)를 반영해야 한다.
- F5.2 통계(개수/평균/최대/최소)와 분포, Top5를 제공해야 한다.

F6. 필터
- F6.1 지역(시·군·구/읍·면·동) 필터를 제공해야 한다.
- F6.2 위험도 등급 필터를 제공해야 한다.
- F6.3 지하철 영향권 필터를 제공해야 한다.

F7. 실시간 데이터 수집 및 동기화(복구 후)
- F7.1 시스템은 공공데이터 REST API를 호출해 신규/갱신 데이터를 수집할 수 있어야 한다.
- F7.2 페이지네이션/속도 제한을 준수하고, 실패 시 지수 백오프로 재시도해야 한다.
- F7.3 수집된 필드는 기존 정규화 스키마(위도/경도/발생일 등)로 매핑되어야 한다.
- F7.4 API 장애 시 정적 CSV로 자동 폴백해야 한다.
- F7.5 동기화 주기는 환경설정으로 조정 가능해야 한다(예: 매 1시간/1일).

### 5. 비기능 요구사항
N1. 성능
- N1.1 지도 이동/줌 중 히트맵을 임시 해제해 프레임 드랍을 완화해야 한다.
 - N1.2 API 호출 한도 내에서 배치/캐시 전략으로 부하를 최소화해야 한다.

N2. 보안
- N2.1 지도 API 키는 환경변수로 관리되어야 한다.
- N2.2 개발 CORS는 와일드카드 허용, 운영 시 도메인 제한 가능해야 한다.
 - N2.3 공공데이터 API 키는 환경변수로 안전하게 관리되어야 한다.

N3. 품질
- N3.1 코드 가독성/일관된 코딩컨벤션 유지(2칸 들여쓰기, 80자 권장)
- N3.2 하드코딩값 상수화, 단일 책임 원칙

N4. 운영
- N4.1 Windows 기반 개발/운영 환경 지원
- N4.2 GitHub Pages 배포 스크립트 제공
 - N4.3 API 장애 시 정적 CSV로 자동 폴백하고 장애 상태를 로깅/모니터링해야 한다.
 - N4.4 동기화 주기/재시도 파라미터는 구성 가능해야 한다.

### 6. 제약과 가정
- 정적 CSV의 품질/정확성에 의존
- 네이버 지도 Web API v3 사용 가능 가정
 - 공공데이터 API는 국가정보자원관리원 복구 이후 사용 가능하다는 가정

### 7. 수용 기준
- 지도/히트맵/마커/영향권이 오류 없이 렌더링되어야 한다.
- 시뮬레이션 파라미터 변경 시 통계/분포/Top5가 즉시 반영되어야 한다.
- 필터 적용 시 지도와 목록의 결과가 일관되어야 한다.
 - (실시간 모드) API 정상 시 신규 데이터가 동기화 주기 내 지도/목록/통계에 반영되어야 한다.
 - (장애 시) 폴백 전환 후 기능이 지속 동작해야 하며 사용자 오류가 발생하지 않아야 한다.


